var express=require("express"),app=express(),bodyParser=require("body-parser"),cors=require("cors"),watson=require("watson-developer-cloud"),port=process.env.PORT||3e3;app.use(express.static(__dirname+"/dist")),app.use(cors()),app.use(bodyParser.urlencoded({extended:!1})),app.use(bodyParser.json()),app.get("/sayHello",function(e,n){var o=e.query.user_name;n.end("Hello "+o+"!")});var conversation=watson.conversation({username:"b5c986f3-3d3d-418d-8351-44c6d9f20c15",password:"OaBSf0dRUPuk",url:"https://gateway.watsonplatform.net/conversation/api",version:"v1",version_date:"2016-09-20"}),visual_recognition_carfruits=watson.visual_recognition({api_key:"7e68869fb2fa809332453fd95f94f5117d8d53ee",version_date:"2016-05-20",version:"v3"}),visual_recognition_caraccident=watson.visual_recognition({api_key:"3768bac1246cdd7a709e4cb94604f1b08ea9d24c",version_date:"2016-05-20",version:"v3"});app.post("/conversation",function(e,n){var o=e.body,s=o.message,i="";i=null!=o.context?JSON.parse(o.context):{},conversation.message({workspace_id:"9f919328-5d6f-464b-a2ff-ea9bb86f8c2e",input:{text:s},context:i},function(e,o){e?console.log("error:",e):(n.setHeader("Content-Type","application/json"),n.send(JSON.stringify(o)))})}),app.post("/visualRecognition",function(e,n){var o="";o=null!=body.context?JSON.parse(body.context):{};var s=e.body.url,i={url:s,classifier_ids:["fruits_1741951189"]},t={url:s,classifier_ids:["accident_164647303"]};visual_recognition_carfruits.classify(i,function(e,s){e?console.log(e):(console.log(JSON.stringify(s,null,2)),s.images[0].classifiers.length>0?(o.isCar=!1,o.isAccident=!1,conversation.message({workspace_id:"9f919328-5d6f-464b-a2ff-ea9bb86f8c2e",input:{text:""},context:o},function(e,o){e?console.log("error:",e):(n.setHeader("Content-Type","application/json"),n.send(JSON.stringify(o)))})):visual_recognition_caraccident.classify(t,function(e,s){e?console.log(e):(console.log(JSON.stringify(s,null,2)),s.images[0].classifiers.length>0?(o.isCar=!0,o.isAccident=!0,conversation.message({workspace_id:"9f919328-5d6f-464b-a2ff-ea9bb86f8c2e",input:{text:""},context:o},function(e,o){e?console.log("error:",e):(n.setHeader("Content-Type","application/json"),n.send(JSON.stringify(o)))})):(o.isCar=!0,o.isAccident=!1,conversation.message({workspace_id:"9f919328-5d6f-464b-a2ff-ea9bb86f8c2e",input:{text:""},context:o},function(e,o){e?console.log("error:",e):(n.setHeader("Content-Type","application/json"),n.send(JSON.stringify(o)))})))}))})}),app.listen(port),console.log("Listening on port ",port),require("cf-deployment-tracker-client").track();
//# sourceMappingURL=app.js.map